<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot de Trading de Divisas con IA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="static/css/styles.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

</head>

<body>
    <div class="container-fluid w-100 overflow-hidden">
        <!-- Encabezado -->
        <div class="row mb-4 mt-4">
            <div class="col-12">
                <h1 class="text-center">Asistente de Trading con IA</h1>
                <p class="text-center text-muted">Análisis en tiempo real de pares de divisas</p>
            </div>
        </div>

        <div class="row p-4">
            <!-- Gráfico de precios -->
            <div class="col-lg-6">
                <div class="card bg-dark text-white h-76">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">BTC/USDT - Gráfico de Precios</h5>
                        <button class="btn btn-sm btn-outline-light" onclick="updateData()">
                            <i class="fas fa-sync-alt me-1"></i> Actualizar
                        </button>
                    </div>
                    <div class="card-body">
                        <div id="graph"></div>
                        <div class="last-update" id="last-update"></div>
                    </div>
                </div>
            </div>

            <!-- Señales de compra/venta -->
            <div class="col-lg-6">

                <!-- Contexto de Mercado -->
                <div class="card mb-3">
                    <div class="card-header">
                        <i class="fas fa-globe me-2"></i>Contexto de Mercado
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-6">
                                <div class="metric-card">
                                    <div class="metric-label">Mercado Lateral</div>
                                    <div class="metric-value" id="sideways-status">
                                        <i class="fas fa-minus-circle text-warning"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="metric-card">
                                    <div class="metric-label">Sentimiento</div>
                                    <div class="metric-value" id="sentiment-status">
                                        <i class="fas fa-minus-circle text-secondary"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="metric-card">
                                    <div class="metric-label">Volatilidad</div>
                                    <div class="metric-value" id="volatility-status">
                                        <i class="fas fa-minus-circle text-secondary"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="metric-card">
                                    <div class="metric-label">Crisis</div>
                                    <div class="metric-value" id="crisis-status">
                                        <i class="fas fa-check-circle text-success"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="blocked-reasons" class="mt-3" style="display: none;">
                            <h6 class="text-danger"><i class="fas fa-ban me-2"></i>Razones de Bloqueo</h6>
                            <ul id="blocked-reasons-list" class="list-unstyled small">
                                <!-- Se llenará dinámicamente -->
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Señal de compra -->
                <div id="buy-signal" class="signal-container mb-3">
                    <div class="signal-header bg-success-gradient text-white p-3 rounded-top">
                        <div class="d-flex align-items-center justify-content-between w-100">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-arrow-circle-up me-2"></i>
                                <h5 class="mb-0">SEÑAL DE COMPRA</h5>
                                <span class="badge bg-light text-dark ms-2 signal-status">
                                    <i class="fas fa-bolt me-1"></i><span class="status-text">INACTIVO</span>
                                </span>
                            </div>
                            <div class="signal-id"><i class="fas fa-fingerprint me-1"></i><span
                                    id="buy-signal-num">--</span></div>
                        </div>
                    </div>
                    <div class="signal-body bg-dark p-3 rounded-bottom">
                        <div class="row g-2">
                            <div class="col-6">
                                <div class="signal-metric">
                                    <small class="text-muted">Precio</small>
                                    <div id="buy-price" class="h5 mb-0">--</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="signal-metric text-end">
                                    <small class="text-muted">Hora</small>
                                    <div id="buy-time" class="h5 mb-0">--:--</div>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="signal-conditions mt-3">
                                    <h6 class="mb-2"><i class="fas fa-list-check"></i> Condiciones de Señal</h6>
                                    <ul class="conditions-list list-unstyled" id="buy-conditions">
                                        <li class="condition-item" id="buy-rsi-condition">
                                            RSI < 30 (Sobreventa) <span class="condition-value" id="buy-rsi-value">
                                                --</span>
                                        </li>
                                        <li class="condition-item" id="buy-macd-condition">
                                            MACD > Señal
                                            <span class="condition-value" id="buy-macd-value">--</span>
                                        </li>
                                        <li class="condition-item" id="buy-sma-condition">
                                            SMA20 > SMA50
                                            <span class="condition-value" id="buy-sma-value">--</span>
                                        </li>
                                        <li class="condition-item" id="buy-adx-condition">
                                            ADX > 25
                                            <span class="condition-value" id="buy-adx-value">--</span>
                                        </li>
                                        <li class="condition-item" id="buy-volume-condition">
                                            Volumen > Media
                                            <span class="condition-value" id="buy-volume-value">--</span>
                                        </li>
                                        <li class="condition-item" id="buy-score-condition">
                                            Puntuación > 0.6
                                            <span class="condition-value" id="buy-score-value">--</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Señal de venta -->
                <div id="sell-signal" class="signal-container">
                    <div class="signal-header bg-danger-gradient text-white p-3 rounded-top">
                        <div class="d-flex align-items-center justify-content-between w-100">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-arrow-circle-down me-2"></i>
                                <h5 class="mb-0">SEÑAL DE VENTA</h5>
                                <span class="badge bg-light text-dark ms-2 signal-status">
                                    <i class="fas fa-bolt me-1"></i><span class="status-text">INACTIVO</span>
                                </span>
                            </div>
                            <div class="signal-id"><i class="fas fa-fingerprint me-1"></i><span
                                    id="sell-signal-num">--</span></div>
                        </div>
                    </div>
                    <div class="signal-body bg-dark p-3 rounded-bottom">
                        <div class="row g-2">
                            <div class="col-6">
                                <div class="signal-metric">
                                    <small class="text-muted">Precio</small>
                                    <div id="sell-price" class="h5 mb-0">--</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="signal-metric text-end">
                                    <small class="text-muted">Hora</small>
                                    <div id="sell-time" class="h5 mb-0">--:--</div>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="signal-conditions mt-3">
                                    <h6 class="mb-2"><i class="fas fa-list-check"></i> Condiciones de Señal</h6>
                                    <ul class="conditions-list list-unstyled" id="sell-conditions">
                                        <li class="condition-item" id="sell-rsi-condition">
                                            RSI > 70 (Sobrecompra)
                                            <span class="condition-value" id="sell-rsi-value">--</span>
                                        </li>
                                        <li class="condition-item" id="sell-macd-condition">
                                            MACD < Señal <span class="condition-value" id="sell-macd-value">--</span>
                                        </li>
                                        <li class="condition-item" id="sell-sma-condition">
                                            SMA20 < SMA50 <span class="condition-value" id="sell-sma-value">--</span>
                                        </li>
                                        <li class="condition-item" id="sell-adx-condition">
                                            ADX > 25
                                            <span class="condition-value" id="sell-adx-value">--</span>
                                        </li>
                                        <li class="condition-item" id="sell-volume-condition">
                                            Volumen > Media
                                            <span class="condition-value" id="sell-volume-value">--</span>
                                        </li>
                                        <li class="condition-item" id="sell-score-condition">
                                            Puntuación < -0.6 <span class="condition-value" id="sell-score-value">
                                                --</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Configuración -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-cog me-2"></i>Configuración
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="symbol" class="form-label"><i class="fas fa-exchange-alt me-1"></i> Par de
                                divisas</label>
                            <select class="form-select bg-dark text-light" id="symbol">
                                <option value="BTC/USDT">BTC/USDT</option>
                                <option value="ETH/USDT">ETH/USDT</option>
                                <option value="XRP/USDT">XRP/USDT</option>
                                <option value="EUR/USD">EUR/USD</option>
                                <option value="GBP/USD">GBP/USD</option>
                                <option value="USD/JPY">USD/JPY</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="timeframe" class="form-label"><i class="far fa-clock me-1"></i> Intervalo de
                                tiempo</label>
                            <select class="form-select bg-dark text-light" id="timeframe">
                                <option value="1m">1 Minuto</option>
                                <option value="5m">5 Minutos</option>
                                <option value="15m">15 Minutos</option>
                                <option value="1h" selected>1 Hora</option>
                                <option value="4h">4 Horas</option>
                                <option value="1d">1 Día</option>
                            </select>
                        </div>
                        <button class="btn btn-primary w-100" onclick="updateSettings()">
                            <i class="fas fa-check-circle me-2"></i>Aplicar Configuración
                        </button>
                    </div>
                </div>
                <!-- Fin Configuración -->
            </div>

            <!-- Análisis Avanzado -->
            <div class="row mt-4">
                <div class="col-12">
                    <h3 class="section-title">Análisis Avanzado</h3>
                </div>
            </div>

            <!-- Indicadores -->
            <div class="row g-4">
                <!-- MACD Card -->
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body">
                            <div class="d-flex align-items-center mb-3">
                                <div class="icon-wrapper bg-primary bg-opacity-10 p-3 rounded-circle me-3">
                                    <i class="fas fa-chart-line text-primary"></i>
                                </div>
                                <h5 class="card-title mb-0">MACD - Convergencia/Divergencia</h5>
                            </div>
                            <div class="d-flex flex-column">
                                <div class="mb-3">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>MACD</span>
                                        <h4 class="mb-0" id="macd-value">-</h4>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>Línea de Señal</span>
                                        <h4 class="mb-0" id="macd-signal-value">-</h4>
                                    </div>
                                    <div class="mt-2 small text-muted">
                                        <i class="fas fa-info-circle me-1"></i>
                                        MACD > Señal: Momento alcista<br>
                                        MACD < Señal: Momento bajista </div>
                                    </div>
                                    <div id="macd-status" class="alert alert-info mb-0">
                                        <i class="fas fa-circle-info me-2"></i>
                                        <span id="macd-interpretation">Analizando momento...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ADX Card with Progress -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="icon-wrapper bg-warning bg-opacity-10 p-3 rounded-circle me-3">
                                        <i class="fas fa-tachometer-alt text-warning"></i>
                                    </div>
                                    <h5 class="card-title mb-0">ADX - Fuerza de Tendencia</h5>
                                </div>
                                <div>
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <span>Valor ADX</span>
                                        <h4 class="mb-0" id="adx-value">-</h4>
                                    </div>
                                    <div class="progress mb-2" style="height: 10px;">
                                        <div id="adx-bar" class="progress-bar" role="progressbar" style="width: 0%">
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between mb-3">
                                        <small class="text-muted">Tendencia Débil<br>(&lt; 25)</small>
                                        <small class="text-warning">Tendencia Moderada<br>(25-50)</small>
                                        <small class="text-success">Tendencia Fuerte<br>(&gt; 50)</small>
                                    </div>
                                    <div id="adx-status" class="alert alert-info mb-0">
                                        <i class="fas fa-circle-info me-2"></i>
                                        <span id="adx-interpretation">Analizando tendencia...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ATR Card with Progress -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="icon-wrapper bg-info bg-opacity-10 p-3 rounded-circle me-3">
                                        <i class="fas fa-bolt text-info"></i>
                                    </div>
                                    <h5 class="card-title mb-0">ATR - Volatilidad del Mercado</h5>
                                </div>
                                <div>
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <span>Valor ATR</span>
                                        <h4 class="mb-0" id="atr-value">-</h4>
                                    </div>
                                    <div class="progress mb-2" style="height: 10px;">
                                        <div id="atr-bar" class="progress-bar" role="progressbar" style="width: 0%">
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between mb-3">
                                        <small class="text-success">Volatilidad Baja<br>Menor Riesgo</small>
                                        <small class="text-warning">Vol. Media<br>Riesgo Moderado</small>
                                        <small class="text-danger">Vol. Alta<br>Mayor Riesgo</small>
                                    </div>
                                    <div id="atr-status" class="alert alert-info mb-0">
                                        <i class="fas fa-circle-info me-2"></i>
                                        <span id="atr-interpretation">Analizando volatilidad...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AI Prediction Card -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="icon-wrapper bg-primary bg-opacity-10 p-3 rounded-circle me-3">
                                        <i class="fas fa-brain text-primary"></i>
                                    </div>
                                    <h5 class="card-title mb-0">Predicción IA</h5>
                                </div>
                                <div class="text-center py-3">
                                    <h3 class="mb-2" id="ai-prediction-action">-</h3>
                                    <h4 class="mb-2 text-muted" id="ai-prediction-value">-</h4>
                                    <div class="progress mb-2" style="height: 12px;">
                                        <div id="ai-confidence-bar" class="progress-bar" role="progressbar"
                                            style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                        </div>
                                    </div>
                                    <span class="badge fs-6" id="ai-confidence-badge">Confianza: -</span>
                                </div>
                                <div class="mt-3">
                                    <div id="ai-recommendation" class="alert text-center mb-0" style="display: none;">
                                        <h5 class="mb-1" id="ai-action-text">-</h5>
                                        <p class="mb-0 small" id="ai-action-reason">-</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Risk Management Card -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="icon-wrapper bg-warning bg-opacity-10 p-3 rounded-circle me-3">
                                        <i class="fas fa-shield-alt text-warning"></i>
                                    </div>
                                    <h5 class="card-title mb-0">Gestión de Riesgo</h5>
                                </div>
                                <div class="py-2">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>Ratio Riesgo/Beneficio:</span>
                                        <span id="risk-reward-ratio" class="badge bg-info">-</span>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>Tamaño Posición:</span>
                                        <span id="position-size" class="badge bg-primary">-</span>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span>Riesgo por Operación:</span>
                                        <span id="trade-risk" class="badge bg-warning">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Volume Analysis Card -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="icon-wrapper bg-success bg-opacity-10 p-3 rounded-circle me-3">
                                        <i class="fas fa-chart-bar text-success"></i>
                                    </div>
                                    <h5 class="card-title mb-0">Análisis de Volumen</h5>
                                </div>
                                <div class="py-2">
                                    <div class="mb-3">
                                        <label class="mb-1">Ratio de Volumen</label>
                                        <div class="progress" style="height: 8px;">
                                            <div id="volume-ratio-bar" class="progress-bar bg-success"
                                                role="progressbar" style="width: 0%"></div>
                                        </div>
                                        <small id="volume-ratio-value" class="text-muted">-</small>
                                    </div>
                                    <div class="alert alert-info p-2 mb-0" id="volume-alert" style="display: none;">
                                        <i class="fas fa-exclamation-circle me-2"></i>
                                        <span>Volumen anormal detectado</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> <!-- Market Status Card -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="icon-wrapper bg-info bg-opacity-10 p-3 rounded-circle me-3">
                                        <i class="fas fa-chart-line text-info"></i>
                                    </div>
                                    <h5 class="card-title mb-0">Estado del Mercado</h5>
                                </div>
                                <div class="text-center py-3">
                                    <h2 class="mb-3" id="trend-status-value">-</h2>
                                    <span class="badge" id="market-trend-badge"
                                        style="font-size: 1rem; padding: 0.5rem 1rem;">-</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- RSI Card -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 border-0 shadow-sm">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="icon-wrapper bg-danger bg-opacity-10 p-3 rounded-circle me-3">
                                        <i class="fas fa-arrows-alt-v text-danger"></i>
                                    </div>
                                    <h5 class="card-title mb-0">RSI - Fuerza del Mercado</h5>
                                </div>
                                <div class="text-center">
                                    <div class="mb-3">
                                        <h3 class="display-4 mb-0" id="rsi-value">-</h3>
                                        <small class="text-muted">Valor RSI (0-100)</small>
                                    </div>
                                    <div class="rsi-indicator mx-auto mb-3">
                                        <div class="progress" style="height: 15px; border-radius: 10px;">
                                            <div id="rsi-bar" class="progress-bar" role="progressbar" style="width: 0%">
                                            </div>
                                        </div>
                                        <div class="rsi-scale d-flex justify-content-between mt-2">
                                            <div class="rsi-segment">
                                                <div class="text-danger">Sobrevendido</div>
                                                <small class="text-muted">0-30</small>
                                            </div>
                                            <div class="rsi-segment">
                                                <div class="text-warning">Neutral</div>
                                                <small class="text-muted">30-70</small>
                                            </div>
                                            <div class="rsi-segment">
                                                <div class="text-success">Sobrecomprado</div>
                                                <small class="text-muted">70-100</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="rsi-status" class="alert alert-info mb-0 text-start">
                                        <i class="fas fa-circle-info me-2"></i>
                                        <span id="rsi-interpretation">Analizando fuerza del mercado...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- IA Recommendations -->
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-robot me-2"></i>Recomendaciones de IA
                            </div>
                            <div class="card-body" id="recommendations">
                                <p>El bot está analizando el mercado. Por favor espere mientras se cargan los datos
                                    iniciales...</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
        <script src="static/js/app.js"></script>
</body>

</html>